/**
    State for actually playing a pseudo-randomly generated level.
    Code by Pedro Esteves, 2022.
**/

class PredefinedLevelState extends LevelState {
    constructor(difficulty, type) {
        super(difficulty, type);

        Mario.MarioCharacter.ResetMetrics();
        Mario.MarioCharacter.gameplayMetrics.SetLevelState(this);

        this.NextLevel = false;
        this.agent = new PlayerAgent();
        //AIAgent([{"t":4,"k":83,"e":"keyup"},{"t":25,"k":39,"e":"keydown"},{"t":30,"k":65,"e":"keydown"},{"t":35,"k":83,"e":"keydown"},{"t":40,"k":83,"e":"keyup"},{"t":53,"k":83,"e":"keydown"},{"t":57,"k":83,"e":"keyup"},{"t":66,"k":83,"e":"keydown"},{"t":70,"k":83,"e":"keyup"},{"t":74,"k":39,"e":"keyup"},{"t":77,"k":37,"e":"keydown"},{"t":92,"k":37,"e":"keydown"},{"t":93,"k":37,"e":"keydown"},{"t":94,"k":37,"e":"keydown"},{"t":95,"k":37,"e":"keydown"},{"t":96,"k":37,"e":"keydown"},{"t":97,"k":37,"e":"keydown"},{"t":98,"k":37,"e":"keydown"},{"t":99,"k":37,"e":"keydown"},{"t":99,"k":83,"e":"keydown"},{"t":99,"k":37,"e":"keyup"},{"t":99,"k":39,"e":"keydown"},{"t":102,"k":83,"e":"keyup"},{"t":112,"k":83,"e":"keydown"},{"t":115,"k":83,"e":"keyup"},{"t":121,"k":83,"e":"keydown"},{"t":123,"k":83,"e":"keyup"},{"t":130,"k":83,"e":"keydown"},{"t":133,"k":83,"e":"keyup"},{"t":147,"k":39,"e":"keyup"},{"t":154,"k":83,"e":"keydown"},{"t":158,"k":83,"e":"keyup"},{"t":164,"k":83,"e":"keydown"},{"t":168,"k":83,"e":"keyup"},{"t":172,"k":39,"e":"keydown"},{"t":172,"k":83,"e":"keydown"},{"t":177,"k":83,"e":"keyup"},{"t":177,"k":39,"e":"keyup"},{"t":180,"k":83,"e":"keydown"},{"t":183,"k":83,"e":"keyup"},{"t":190,"k":37,"e":"keydown"},{"t":195,"k":83,"e":"keydown"},{"t":196,"k":37,"e":"keyup"},{"t":199,"k":83,"e":"keyup"},{"t":200,"k":39,"e":"keydown"},{"t":210,"k":83,"e":"keydown"},{"t":213,"k":83,"e":"keyup"},{"t":223,"k":39,"e":"keyup"},{"t":224,"k":83,"e":"keydown"},{"t":228,"k":83,"e":"keyup"},{"t":234,"k":83,"e":"keydown"},{"t":238,"k":83,"e":"keyup"},{"t":243,"k":37,"e":"keydown"},{"t":248,"k":83,"e":"keydown"},{"t":248,"k":37,"e":"keyup"},{"t":251,"k":39,"e":"keydown"},{"t":251,"k":83,"e":"keyup"},{"t":263,"k":39,"e":"keyup"},{"t":263,"k":83,"e":"keydown"},{"t":265,"k":37,"e":"keydown"},{"t":267,"k":83,"e":"keyup"},{"t":280,"k":37,"e":"keydown"},{"t":280,"k":37,"e":"keydown"},{"t":282,"k":37,"e":"keyup"},{"t":292,"k":39,"e":"keydown"},{"t":294,"k":39,"e":"keyup"},{"t":297,"k":39,"e":"keydown"},{"t":298,"k":83,"e":"keydown"},{"t":302,"k":83,"e":"keyup"},{"t":319,"k":39,"e":"keyup"},{"t":321,"k":39,"e":"keydown"},{"t":328,"k":39,"e":"keyup"},{"t":329,"k":83,"e":"keydown"},{"t":334,"k":83,"e":"keyup"},{"t":346,"k":37,"e":"keydown"},{"t":350,"k":83,"e":"keydown"},{"t":351,"k":37,"e":"keyup"},{"t":353,"k":83,"e":"keyup"},{"t":354,"k":37,"e":"keydown"},{"t":355,"k":37,"e":"keyup"},{"t":365,"k":37,"e":"keydown"},{"t":367,"k":83,"e":"keydown"},{"t":368,"k":37,"e":"keyup"},{"t":370,"k":83,"e":"keyup"},{"t":370,"k":39,"e":"keydown"},{"t":380,"k":39,"e":"keyup"},{"t":380,"k":83,"e":"keydown"},{"t":383,"k":83,"e":"keyup"},{"t":384,"k":65,"e":"keyup"},{"t":384,"k":65,"e":"keydown"},{"t":390,"k":83,"e":"keydown"},{"t":392,"k":83,"e":"keyup"},{"t":394,"k":37,"e":"keydown"},{"t":404,"k":37,"e":"keyup"},{"t":404,"k":83,"e":"keydown"},{"t":408,"k":83,"e":"keyup"},{"t":408,"k":39,"e":"keydown"},{"t":414,"k":39,"e":"keyup"},{"t":417,"k":39,"e":"keydown"},{"t":425,"k":39,"e":"keyup"},{"t":426,"k":83,"e":"keydown"},{"t":426,"k":37,"e":"keydown"},{"t":438,"k":83,"e":"keyup"},{"t":442,"k":37,"e":"keydown"},{"t":442,"k":37,"e":"keydown"},{"t":443,"k":37,"e":"keydown"},{"t":444,"k":83,"e":"keydown"},{"t":447,"k":83,"e":"keyup"},{"t":451,"k":37,"e":"keyup"},{"t":460,"k":65,"e":"keyup"},{"t":460,"k":39,"e":"keydown"},{"t":462,"k":65,"e":"keydown"},{"t":463,"k":83,"e":"keydown"},{"t":467,"k":83,"e":"keyup"},{"t":475,"k":83,"e":"keydown"},{"t":476,"k":39,"e":"keyup"},{"t":479,"k":83,"e":"keyup"},{"t":482,"k":83,"e":"keydown"},{"t":485,"k":83,"e":"keyup"},{"t":488,"k":83,"e":"keydown"},{"t":491,"k":83,"e":"keyup"},{"t":495,"k":83,"e":"keydown"},{"t":496,"k":39,"e":"keydown"},{"t":498,"k":83,"e":"keyup"},{"t":499,"k":39,"e":"keyup"},{"t":501,"k":83,"e":"keydown"},{"t":505,"k":83,"e":"keyup"},{"t":506,"k":37,"e":"keydown"},{"t":513,"k":83,"e":"keydown"},{"t":514,"k":37,"e":"keyup"},{"t":517,"k":83,"e":"keyup"},{"t":522,"k":39,"e":"keydown"},{"t":525,"k":39,"e":"keyup"},{"t":527,"k":37,"e":"keydown"},{"t":530,"k":83,"e":"keydown"},{"t":533,"k":37,"e":"keyup"},{"t":533,"k":83,"e":"keyup"},{"t":540,"k":83,"e":"keydown"},{"t":544,"k":39,"e":"keydown"},{"t":545,"k":83,"e":"keyup"},{"t":553,"k":83,"e":"keydown"},{"t":561,"k":83,"e":"keyup"},{"t":571,"k":39,"e":"keyup"},{"t":581,"k":83,"e":"keydown"},{"t":581,"k":39,"e":"keydown"},{"t":583,"k":83,"e":"keyup"},{"t":596,"k":39,"e":"keydown"},{"t":597,"k":39,"e":"keydown"},{"t":598,"k":39,"e":"keydown"},{"t":599,"k":39,"e":"keydown"},{"t":600,"k":39,"e":"keydown"},{"t":601,"k":39,"e":"keydown"},{"t":602,"k":39,"e":"keydown"},{"t":602,"k":39,"e":"keydown"},{"t":604,"k":39,"e":"keydown"},{"t":605,"k":39,"e":"keydown"},{"t":605,"k":83,"e":"keydown"},{"t":606,"k":39,"e":"keyup"},{"t":607,"k":39,"e":"keydown"},{"t":609,"k":83,"e":"keyup"},{"t":618,"k":39,"e":"keyup"},{"t":623,"k":83,"e":"keydown"},{"t":625,"k":83,"e":"keyup"},{"t":629,"k":83,"e":"keydown"},{"t":633,"k":83,"e":"keyup"},{"t":637,"k":83,"e":"keydown"},{"t":640,"k":83,"e":"keyup"},{"t":642,"k":37,"e":"keydown"},{"t":648,"k":83,"e":"keydown"},{"t":649,"k":37,"e":"keyup"},{"t":652,"k":83,"e":"keyup"},{"t":654,"k":37,"e":"keydown"},{"t":657,"k":37,"e":"keyup"},{"t":658,"k":83,"e":"keydown"},{"t":660,"k":39,"e":"keydown"},{"t":662,"k":83,"e":"keyup"},{"t":665,"k":39,"e":"keyup"},{"t":673,"k":39,"e":"keydown"},{"t":675,"k":83,"e":"keydown"},{"t":676,"k":39,"e":"keyup"},{"t":678,"k":83,"e":"keyup"},{"t":682,"k":37,"e":"keydown"},{"t":684,"k":83,"e":"keydown"},{"t":688,"k":37,"e":"keyup"},{"t":688,"k":39,"e":"keydown"},{"t":698,"k":83,"e":"keyup"},{"t":699,"k":39,"e":"keyup"},{"t":706,"k":39,"e":"keydown"},{"t":711,"k":83,"e":"keydown"},{"t":719,"k":83,"e":"keyup"},{"t":723,"k":83,"e":"keydown"},{"t":727,"k":83,"e":"keyup"},{"t":731,"k":65,"e":"keyup"},{"t":736,"k":65,"e":"keydown"},{"t":737,"k":83,"e":"keydown"},{"t":740,"k":83,"e":"keyup"},{"t":747,"k":83,"e":"keydown"},{"t":747,"k":39,"e":"keyup"},{"t":752,"k":83,"e":"keyup"},{"t":757,"k":83,"e":"keydown"},{"t":760,"k":83,"e":"keyup"},{"t":766,"k":83,"e":"keydown"},{"t":768,"k":83,"e":"keyup"},{"t":775,"k":37,"e":"keydown"},{"t":780,"k":37,"e":"keyup"},{"t":780,"k":83,"e":"keydown"},{"t":781,"k":39,"e":"keydown"},{"t":783,"k":83,"e":"keyup"},{"t":794,"k":39,"e":"keyup"},{"t":795,"k":83,"e":"keydown"},{"t":798,"k":83,"e":"keyup"},{"t":804,"k":37,"e":"keydown"},{"t":813,"k":37,"e":"keyup"},{"t":815,"k":39,"e":"keydown"},{"t":815,"k":83,"e":"keydown"},{"t":818,"k":83,"e":"keyup"},{"t":829,"k":39,"e":"keyup"},{"t":831,"k":37,"e":"keydown"},{"t":843,"k":37,"e":"keyup"},{"t":844,"k":83,"e":"keydown"},{"t":847,"k":83,"e":"keyup"},{"t":847,"k":37,"e":"keydown"},{"t":850,"k":37,"e":"keyup"},{"t":856,"k":37,"e":"keydown"},{"t":857,"k":83,"e":"keydown"},{"t":864,"k":37,"e":"keyup"},{"t":866,"k":83,"e":"keyup"},{"t":867,"k":39,"e":"keydown"},{"t":882,"k":39,"e":"keydown"},{"t":883,"k":39,"e":"keydown"},{"t":884,"k":39,"e":"keydown"},{"t":884,"k":39,"e":"keydown"},{"t":885,"k":39,"e":"keydown"},{"t":886,"k":39,"e":"keydown"},{"t":887,"k":39,"e":"keydown"},{"t":888,"k":39,"e":"keydown"},{"t":889,"k":39,"e":"keydown"},{"t":890,"k":39,"e":"keydown"},{"t":891,"k":39,"e":"keydown"},{"t":892,"k":83,"e":"keydown"},{"t":894,"k":83,"e":"keyup"},{"t":900,"k":39,"e":"keyup"},{"t":904,"k":83,"e":"keydown"},{"t":907,"k":37,"e":"keydown"},{"t":908,"k":83,"e":"keyup"},{"t":911,"k":83,"e":"keydown"},{"t":914,"k":37,"e":"keyup"},{"t":914,"k":83,"e":"keyup"},{"t":919,"k":83,"e":"keydown"},{"t":921,"k":83,"e":"keyup"},{"t":925,"k":39,"e":"keydown"},{"t":926,"k":83,"e":"keydown"},{"t":928,"k":83,"e":"keyup"},{"t":935,"k":39,"e":"keyup"},{"t":935,"k":83,"e":"keydown"},{"t":939,"k":83,"e":"keyup"},{"t":943,"k":39,"e":"keydown"},{"t":958,"k":39,"e":"keydown"},{"t":960,"k":39,"e":"keydown"},{"t":960,"k":39,"e":"keyup"},{"t":960,"k":83,"e":"keydown"},{"t":963,"k":83,"e":"keyup"},{"t":967,"k":83,"e":"keydown"},{"t":968,"k":37,"e":"keydown"},{"t":970,"k":83,"e":"keyup"},{"t":977,"k":37,"e":"keyup"},{"t":981,"k":83,"e":"keydown"},{"t":984,"k":83,"e":"keyup"},{"t":986,"k":39,"e":"keydown"},{"t":990,"k":39,"e":"keyup"},{"t":993,"k":83,"e":"keydown"},{"t":996,"k":83,"e":"keyup"},{"t":1001,"k":39,"e":"keydown"},{"t":1012,"k":39,"e":"keyup"},{"t":1020,"k":83,"e":"keydown"},{"t":1022,"k":83,"e":"keyup"},{"t":1028,"k":83,"e":"keydown"},{"t":1031,"k":83,"e":"keyup"},{"t":1033,"k":39,"e":"keydown"},{"t":1037,"k":39,"e":"keyup"},{"t":1037,"k":83,"e":"keydown"},{"t":1040,"k":83,"e":"keyup"},{"t":1043,"k":83,"e":"keydown"},{"t":1046,"k":83,"e":"keyup"},{"t":1050,"k":83,"e":"keydown"},{"t":1053,"k":83,"e":"keyup"},{"t":1057,"k":83,"e":"keydown"},{"t":1060,"k":83,"e":"keyup"},{"t":1061,"k":39,"e":"keydown"},{"t":1064,"k":39,"e":"keyup"},{"t":1065,"k":83,"e":"keydown"},{"t":1068,"k":83,"e":"keyup"},{"t":1071,"k":83,"e":"keydown"},{"t":1072,"k":37,"e":"keydown"},{"t":1074,"k":83,"e":"keyup"},{"t":1082,"k":37,"e":"keyup"},{"t":1084,"k":83,"e":"keydown"},{"t":1088,"k":83,"e":"keyup"},{"t":1092,"k":83,"e":"keydown"},{"t":1095,"k":83,"e":"keyup"},{"t":1095,"k":37,"e":"keydown"},{"t":1097,"k":37,"e":"keyup"},{"t":1099,"k":83,"e":"keydown"},{"t":1102,"k":83,"e":"keyup"},{"t":1105,"k":39,"e":"keydown"},{"t":1108,"k":39,"e":"keyup"},{"t":1116,"k":39,"e":"keydown"},{"t":1121,"k":39,"e":"keyup"},{"t":1122,"k":83,"e":"keydown"},{"t":1130,"k":83,"e":"keyup"},{"t":1139,"k":39,"e":"keydown"},{"t":1151,"k":83,"e":"keydown"},{"t":1153,"k":39,"e":"keyup"},{"t":1154,"k":83,"e":"keyup"},{"t":1166,"k":39,"e":"keydown"},{"t":1170,"k":39,"e":"keyup"},{"t":1171,"k":83,"e":"keydown"},{"t":1174,"k":83,"e":"keyup"},{"t":1178,"k":83,"e":"keydown"},{"t":1182,"k":83,"e":"keyup"},{"t":1190,"k":39,"e":"keydown"},{"t":1192,"k":83,"e":"keydown"},{"t":1194,"k":39,"e":"keyup"},{"t":1196,"k":83,"e":"keyup"},{"t":1197,"k":65,"e":"keyup"},{"t":1197,"k":65,"e":"keydown"},{"t":1197,"k":37,"e":"keydown"},{"t":1208,"k":37,"e":"keyup"},{"t":1210,"k":83,"e":"keydown"},{"t":1213,"k":83,"e":"keyup"},{"t":1213,"k":39,"e":"keydown"},{"t":1214,"k":39,"e":"keyup"},{"t":1220,"k":83,"e":"keydown"},{"t":1222,"k":39,"e":"keydown"},{"t":1234,"k":83,"e":"keyup"},{"t":1237,"k":39,"e":"keydown"},{"t":1237,"k":39,"e":"keyup"},{"t":1242,"k":39,"e":"keydown"},{"t":1252,"k":39,"e":"keyup"},{"t":1252,"k":83,"e":"keydown"},{"t":1252,"k":37,"e":"keydown"},{"t":1265,"k":37,"e":"keyup"},{"t":1265,"k":83,"e":"keyup"},{"t":1267,"k":39,"e":"keydown"},{"t":1273,"k":83,"e":"keydown"},{"t":1278,"k":83,"e":"keyup"},{"t":1285,"k":83,"e":"keydown"},{"t":1290,"k":83,"e":"keyup"},{"t":1292,"k":39,"e":"keyup"},{"t":1297,"k":83,"e":"keydown"},{"t":1300,"k":37,"e":"keydown"},{"t":1301,"k":37,"e":"keyup"},{"t":1303,"k":65,"e":"keyup"},{"t":1304,"k":37,"e":"keydown"},{"t":1306,"k":37,"e":"keyup"},{"t":1306,"k":83,"e":"keyup"},{"t":1332,"k":37,"e":"keydown"},{"t":1332,"k":65,"e":"keydown"},{"t":1333,"k":83,"e":"keydown"},{"t":1338,"k":37,"e":"keyup"},{"t":1340,"k":83,"e":"keyup"},{"t":1340,"k":65,"e":"keyup"},{"t":1346,"k":39,"e":"keydown"},{"t":1349,"k":39,"e":"keyup"},{"t":1349,"k":83,"e":"keydown"},{"t":1352,"k":65,"e":"keydown"},{"t":1354,"k":39,"e":"keydown"},{"t":1356,"k":39,"e":"keyup"},{"t":1363,"k":65,"e":"keyup"},{"t":1364,"k":83,"e":"keyup"},{"t":1370,"k":83,"e":"keydown"},{"t":1374,"k":83,"e":"keyup"},{"t":1374,"k":37,"e":"keydown"},{"t":1378,"k":83,"e":"keydown"},{"t":1379,"k":37,"e":"keyup"},{"t":1380,"k":65,"e":"keydown"},{"t":1384,"k":83,"e":"keyup"},{"t":1385,"k":65,"e":"keyup"},{"t":1391,"k":37,"e":"keydown"},{"t":1393,"k":65,"e":"keydown"},{"t":1393,"k":83,"e":"keydown"},{"t":1395,"k":37,"e":"keyup"},{"t":1397,"k":65,"e":"keyup"},{"t":1398,"k":83,"e":"keyup"},{"t":1401,"k":39,"e":"keydown"},{"t":1410,"k":65,"e":"keydown"},{"t":1411,"k":83,"e":"keydown"},{"t":1415,"k":83,"e":"keyup"},{"t":1419,"k":83,"e":"keydown"},{"t":1423,"k":83,"e":"keyup"},{"t":1429,"k":39,"e":"keyup"},{"t":1431,"k":83,"e":"keydown"},{"t":1435,"k":83,"e":"keyup"},{"t":1439,"k":83,"e":"keydown"},{"t":1443,"k":83,"e":"keyup"},{"t":1447,"k":83,"e":"keydown"},{"t":1448,"k":39,"e":"keydown"},{"t":1452,"k":83,"e":"keyup"},{"t":1454,"k":39,"e":"keyup"},{"t":1461,"k":39,"e":"keydown"},{"t":1469,"k":39,"e":"keyup"},{"t":1473,"k":83,"e":"keydown"},{"t":1478,"k":83,"e":"keyup"},{"t":1481,"k":83,"e":"keydown"},{"t":1484,"k":83,"e":"keyup"},{"t":1489,"k":83,"e":"keydown"},{"t":1492,"k":83,"e":"keyup"},{"t":1497,"k":39,"e":"keydown"},{"t":1498,"k":83,"e":"keydown"},{"t":1501,"k":83,"e":"keyup"},{"t":1501,"k":39,"e":"keyup"},{"t":1505,"k":83,"e":"keydown"},{"t":1508,"k":83,"e":"keyup"},{"t":1513,"k":39,"e":"keydown"},{"t":1513,"k":83,"e":"keydown"},{"t":1514,"k":39,"e":"keyup"},{"t":1516,"k":83,"e":"keyup"},{"t":1522,"k":39,"e":"keydown"},{"t":1527,"k":83,"e":"keydown"},{"t":1530,"k":83,"e":"keyup"},{"t":1531,"k":65,"e":"keyup"},{"t":1532,"k":65,"e":"keydown"},{"t":1533,"k":39,"e":"keyup"},{"t":1547,"k":65,"e":"keydown"},{"t":1548,"k":65,"e":"keydown"},{"t":1549,"k":65,"e":"keydown"},{"t":1550,"k":65,"e":"keydown"},{"t":1551,"k":37,"e":"keydown"},{"t":1555,"k":83,"e":"keydown"},{"t":1557,"k":37,"e":"keyup"},{"t":1557,"k":83,"e":"keyup"},{"t":1558,"k":65,"e":"keyup"},{"t":1558,"k":65,"e":"keydown"},{"t":1569,"k":39,"e":"keydown"},{"t":1582,"k":39,"e":"keyup"},{"t":1582,"k":83,"e":"keydown"},{"t":1587,"k":83,"e":"keyup"},{"t":1592,"k":83,"e":"keydown"},{"t":1595,"k":83,"e":"keyup"},{"t":1601,"k":37,"e":"keydown"},{"t":1607,"k":37,"e":"keyup"},{"t":1607,"k":83,"e":"keydown"},{"t":1610,"k":39,"e":"keydown"},{"t":1611,"k":83,"e":"keyup"},{"t":1623,"k":83,"e":"keydown"},{"t":1626,"k":83,"e":"keyup"},{"t":1634,"k":39,"e":"keyup"},{"t":1637,"k":83,"e":"keydown"},{"t":1640,"k":83,"e":"keyup"},{"t":1650,"k":37,"e":"keydown"},{"t":1650,"k":83,"e":"keydown"},{"t":1653,"k":83,"e":"keyup"},{"t":1654,"k":65,"e":"keyup"},{"t":1654,"k":65,"e":"keydown"},{"t":1660,"k":37,"e":"keyup"},{"t":1661,"k":83,"e":"keydown"},{"t":1663,"k":83,"e":"keyup"},{"t":1666,"k":39,"e":"keydown"},{"t":1679,"k":83,"e":"keydown"},{"t":1682,"k":83,"e":"keyup"},{"t":1697,"k":83,"e":"keydown"},{"t":1697,"k":39,"e":"keyup"},{"t":1700,"k":83,"e":"keyup"},{"t":1704,"k":39,"e":"keydown"},{"t":1706,"k":39,"e":"keyup"},{"t":1709,"k":39,"e":"keydown"},{"t":1712,"k":39,"e":"keyup"},{"t":1712,"k":83,"e":"keydown"},{"t":1720,"k":83,"e":"keyup"},{"t":1722,"k":39,"e":"keydown"},{"t":1724,"k":39,"e":"keyup"},{"t":1725,"k":83,"e":"keydown"},{"t":1728,"k":83,"e":"keyup"},{"t":1732,"k":39,"e":"keydown"},{"t":1744,"k":39,"e":"keyup"},{"t":1749,"k":39,"e":"keydown"},{"t":1753,"k":83,"e":"keydown"},{"t":1754,"k":39,"e":"keyup"},{"t":1758,"k":83,"e":"keyup"},{"t":1764,"k":83,"e":"keydown"},{"t":1768,"k":83,"e":"keyup"},{"t":1772,"k":39,"e":"keydown"},{"t":1775,"k":83,"e":"keydown"},{"t":1777,"k":39,"e":"keyup"},{"t":1779,"k":83,"e":"keyup"},{"t":1783,"k":39,"e":"keydown"},{"t":1784,"k":83,"e":"keydown"},{"t":1788,"k":83,"e":"keyup"},{"t":1788,"k":39,"e":"keyup"},{"t":1799,"k":83,"e":"keydown"},{"t":1800,"k":39,"e":"keydown"},{"t":1804,"k":83,"e":"keyup"},{"t":1805,"k":39,"e":"keyup"},{"t":1814,"k":83,"e":"keydown"},{"t":1817,"k":39,"e":"keydown"},{"t":1819,"k":83,"e":"keyup"},{"t":1821,"k":39,"e":"keyup"},{"t":1823,"k":83,"e":"keydown"},{"t":1826,"k":83,"e":"keyup"},{"t":1831,"k":83,"e":"keydown"},{"t":1833,"k":83,"e":"keyup"},{"t":1839,"k":83,"e":"keydown"},{"t":1844,"k":83,"e":"keyup"},{"t":1849,"k":39,"e":"keydown"},{"t":1853,"k":39,"e":"keyup"},{"t":1857,"k":39,"e":"keydown"},{"t":1872,"k":39,"e":"keydown"},{"t":1873,"k":39,"e":"keydown"},{"t":1874,"k":39,"e":"keydown"},{"t":1874,"k":39,"e":"keydown"},{"t":1876,"k":39,"e":"keydown"},{"t":1876,"k":39,"e":"keydown"},{"t":1877,"k":39,"e":"keydown"},{"t":1878,"k":39,"e":"keydown"},{"t":1879,"k":39,"e":"keydown"},{"t":1879,"k":39,"e":"keyup"},{"t":1880,"k":83,"e":"keydown"},{"t":1884,"k":83,"e":"keyup"},{"t":1890,"k":83,"e":"keydown"},{"t":1894,"k":83,"e":"keyup"},{"t":1903,"k":37,"e":"keydown"},{"t":1914,"k":37,"e":"keyup"},{"t":1915,"k":83,"e":"keydown"},{"t":1916,"k":39,"e":"keydown"},{"t":1928,"k":83,"e":"keyup"},{"t":1931,"k":39,"e":"keydown"},{"t":1932,"k":39,"e":"keydown"},{"t":1933,"k":39,"e":"keydown"},{"t":1934,"k":39,"e":"keydown"},{"t":1935,"k":39,"e":"keydown"},{"t":1935,"k":39,"e":"keydown"},{"t":1936,"k":39,"e":"keydown"},{"t":1937,"k":39,"e":"keydown"},{"t":1938,"k":39,"e":"keydown"},{"t":1939,"k":39,"e":"keydown"},{"t":1940,"k":39,"e":"keydown"},{"t":1941,"k":39,"e":"keydown"},{"t":1942,"k":39,"e":"keydown"},{"t":1943,"k":39,"e":"keydown"},{"t":1943,"k":39,"e":"keydown"},{"t":1945,"k":39,"e":"keydown"},{"t":1945,"k":83,"e":"keydown"},{"t":1956,"k":83,"e":"keyup"},{"t":1966,"k":83,"e":"keydown"},{"t":1977,"k":83,"e":"keyup"},{"t":1978,"k":65,"e":"keyup"},{"t":1988,"k":39,"e":"keyup"}]);
    }

    GetLevel() {
        //const lvl = new LevelGenerator(320, 15).CreateLevel(0, 1);
        const lvl = new PredefinedLevelGenerator({"Width":320,"Height":15,"ExitX":264,"ExitY":13,"Type":0,"EnemySpriteTemplates":[{"X":50,"Y":11,"SpriteTemplate":{"Type":1,"Winged":false,"LastVisibleTick":-1,"IsDead":false,"Sprite":null}},{"X":72,"Y":11,"SpriteTemplate":{"Type":2,"Winged":false,"LastVisibleTick":-1,"IsDead":false,"Sprite":null}},{"X":136,"Y":9,"SpriteTemplate":{"Type":1,"Winged":false,"LastVisibleTick":-1,"IsDead":false,"Sprite":null}},{"X":182,"Y":12,"SpriteTemplate":{"Type":2,"Winged":false,"LastVisibleTick":-1,"IsDead":false,"Sprite":null}},{"X":221,"Y":9,"SpriteTemplate":{"Type":2,"Winged":false,"LastVisibleTick":-1,"IsDead":false,"Sprite":null}},{"X":231,"Y":4,"SpriteTemplate":{"Type":1,"Winged":false,"LastVisibleTick":-1,"IsDead":false,"Sprite":null}},{"X":246,"Y":12,"SpriteTemplate":{"Type":1,"Winged":false,"LastVisibleTick":-1,"IsDead":false,"Sprite":null}}],"JumpSections":[{"JS":3,"JL":3,"Length":9,"X0":91,"HasStairs":false,"Floor":13},{"JS":4,"JL":2,"Length":10,"X0":121,"HasStairs":true,"Floor":13},{"JS":3,"JL":3,"Length":9,"X0":203,"HasStairs":false,"Floor":11}],"TubeSections":[{"Length":11,"Floor":11,"XTube":55,"TubeHeight":8,"X0":52,"XTubeRndValues":[0,1],"TubeHeightRndValues":[1,1]},{"Length":8,"Floor":12,"XTube":85,"TubeHeight":10,"X0":83,"XTubeRndValues":[1],"TubeHeightRndValues":[0]},{"Length":14,"Floor":10,"XTube":102,"TubeHeight":7,"X0":100,"XTubeRndValues":[3,2],"TubeHeightRndValues":[0,0]},{"Length":5,"Floor":12,"XTube":118,"TubeHeight":10,"X0":116,"XTubeRndValues":[2],"TubeHeightRndValues":[0]}],"StraightSections":[{"X0":0,"Length":14,"Floor":14,"Decorate":null},{"X0":32,"Length":7,"Floor":13,"Decorate":{"X0":32,"X1":39,"Floor":13,"SBegin":2,"SEnd":0,"EBegin":0,"EEnd":0,"Rnd1":[2,0,1,0,2],"Rnd2":[3,0,2,1,3],"Rnd3":[0,1,2,3,3],"Rnd4":[1,3,0,3,0]}},{"X0":39,"Length":6,"Floor":12,"Decorate":{"X0":39,"X1":45,"Floor":12,"SBegin":3,"SEnd":1,"EBegin":2,"EEnd":3,"Rnd1":[],"Rnd2":[],"Rnd3":[],"Rnd4":[]}},{"X0":45,"Length":7,"Floor":12,"Decorate":{"X0":45,"X1":52,"Floor":12,"SBegin":2,"SEnd":3,"EBegin":1,"EEnd":3,"Rnd1":[],"Rnd2":[],"Rnd3":[],"Rnd4":[]}},{"X0":63,"Length":5,"Floor":13,"Decorate":null},{"X0":68,"Length":9,"Floor":12,"Decorate":{"X0":68,"X1":77,"Floor":12,"SBegin":1,"SEnd":3,"EBegin":3,"EEnd":0,"Rnd1":[0,1,0,0],"Rnd2":[0,2,1,2],"Rnd3":[0,3,0,1],"Rnd4":[3,2,0,0]}},{"X0":77,"Length":2,"Floor":14,"Decorate":null},{"X0":79,"Length":2,"Floor":11,"Decorate":null},{"X0":81,"Length":2,"Floor":12,"Decorate":null},{"X0":114,"Length":2,"Floor":14,"Decorate":null},{"X0":147,"Length":4,"Floor":12,"Decorate":null},{"X0":151,"Length":5,"Floor":12,"Decorate":null},{"X0":156,"Length":7,"Floor":14,"Decorate":{"X0":156,"X1":163,"Floor":14,"SBegin":0,"SEnd":2,"EBegin":0,"EEnd":0,"Rnd1":[1,2,1],"Rnd2":[0,2,1],"Rnd3":[3,2,3],"Rnd4":[3,2,2]}},{"X0":163,"Length":8,"Floor":13,"Decorate":{"X0":163,"X1":171,"Floor":13,"SBegin":2,"SEnd":3,"EBegin":0,"EEnd":3,"Rnd1":[],"Rnd2":[],"Rnd3":[],"Rnd4":[]}},{"X0":196,"Length":7,"Floor":12,"Decorate":{"X0":196,"X1":203,"Floor":12,"SBegin":0,"SEnd":3,"EBegin":1,"EEnd":0,"Rnd1":[],"Rnd2":[],"Rnd3":[],"Rnd4":[]}},{"X0":212,"Length":5,"Floor":13,"Decorate":null}],"HillStraightSections":[{"X0":14,"Length":18,"Floor":13,"Hrnd":[10,6],"Lrnd":[6,7],"XXOrnd":[21,20],"Blocks":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],"DecorateIteration":-1,"Decorate":null},{"X0":131,"Length":16,"Floor":10,"Hrnd":[6],"Lrnd":[4],"XXOrnd":[138],"Blocks":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],"DecorateIteration":0,"Decorate":{"X0":137,"X1":143,"Floor":6,"SBegin":0,"SEnd":3,"EBegin":1,"EEnd":2,"Rnd1":[],"Rnd2":[],"Rnd3":[],"Rnd4":[]}},{"X0":171,"Length":10,"Floor":10,"Hrnd":[5],"Lrnd":[3],"XXOrnd":[173],"Blocks":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],"DecorateIteration":0,"Decorate":{"X0":172,"X1":177,"Floor":5,"SBegin":0,"SEnd":3,"EBegin":0,"EEnd":3,"Rnd1":[],"Rnd2":[],"Rnd3":[],"Rnd4":[]}},{"X0":181,"Length":15,"Floor":13,"Hrnd":[10,6],"Lrnd":[5,3],"XXOrnd":[184,190],"Blocks":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],"DecorateIteration":-1,"Decorate":null},{"X0":217,"Length":10,"Floor":10,"Hrnd":[6,1],"Lrnd":[6,6],"XXOrnd":[218,218],"Blocks":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],"DecorateIteration":-1,"Decorate":null},{"X0":227,"Length":11,"Floor":10,"Hrnd":[5],"Lrnd":[6],"XXOrnd":[230],"Blocks":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],"DecorateIteration":0,"Decorate":{"X0":229,"X1":237,"Floor":5,"SBegin":2,"SEnd":1,"EBegin":1,"EEnd":3,"Rnd1":[],"Rnd2":[],"Rnd3":[],"Rnd4":[]}},{"X0":238,"Length":18,"Floor":13,"Hrnd":[8,5],"Lrnd":[5,7],"XXOrnd":[248,245],"Blocks":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],"DecorateIteration":-1,"Decorate":null}],"CannonSections":[],"CeilingRnd":[],"RunRnd":[]}).CreateLevel();
        console.log(JSON.stringify(lvl.PrintLevel()));
        return lvl;
    }

    Enter() {
        super.Enter();
        this.NextLevel = false;
    }

    CheckForChange(context) {
        if (this.GotoLoseState || this.NextLevel) {
            console.log(Mario.MarioCharacter.gameplayMetrics.PrintMetrics());

            this.agent.StoreActions(); // Store player actions

            context.ChangeState(new PredefinedLevelState(1, 0)); // TODO Count Number os Losses
        }
    }

    LevelWon() {
        Mario.GlobalMapState.LevelWon();
        this.NextLevel = true;
    }

    DrawUI(context) {
        this.DrawStringShadow(context, "MARIO " + Mario.MarioCharacter.Lives, 0, 0);
        this.DrawStringShadow(context, "00000000", 0, 1);
        this.DrawStringShadow(context, "COIN", 14, 0);
        this.DrawStringShadow(context, " " + Mario.MarioCharacter.Coins, 14, 1);
        this.DrawStringShadow(context, "WORLD", 24, 0);
        this.DrawStringShadow(context, " TBD", 24, 1);
        this.DrawStringShadow(context, "TIME", 34, 0);

        let time = this.TimeLeft | 0;
        if (time < 0) time = 0;

        this.DrawStringShadow(context, " " + time, 34, 1);
    }

    Update(delta) {
        this.agent.Update(delta);
        super.Update(delta);
    }
};